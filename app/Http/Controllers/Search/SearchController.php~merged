<?php

namespace App\Http\Controllers\Search;

use App\Http\Controllers\Controller;
use Illuminate\Http\Request;
use App\Models\Listing;

class SearchController extends Controller
{
<<<<<<< HEAD
    public function searchListings(Request $request){
        
        $query = Listing::query();
        // try{
        //     $listings = Listing::search($request->keywords)->get();
        // }catch(Exception $e){
        //     return $this->error(500, $e->getMessage());
        // }
=======
    public function search(Request $request){
        $query = Listing::query();
>>>>>>> e457bfe75963f4ef18478b8769e2a94f6fca9e64
        $query->when($request->query('category'), function($q, $category){
            return $q->where('category', $category);
        });

<<<<<<< HEAD
        // $query->when($request->query('keyword'))

=======
>>>>>>> e457bfe75963f4ef18478b8769e2a94f6fca9e64
        $query->when($request->query('bedrooms'), function($q, $bedrooms){
            return $q->where('bedrooms', $lga);
        });

        $query->when($request->query('bathrooms'), function($q, $bathrooms){
            return $q->where('bathrooms', $bathrooms);
        });

        $query->when($request->query('city'), function($q, $city){
            return $q->where('city', $city);
        });

        $query->when($request->query('areas'), function($q, $areas){
            return $q->where('areas', $areas);
        });
        
        $query->when($request->query('keyword'), function($q, $keyword){
            return $q->where('title', $keyword);
        });

<<<<<<< HEAD
        $query->when($request->query('price'), function($q, $price){
            return $q->where('rent', $price);
        });

        $listings = $query->get();
        return $listings;
    }

    private function filterSearchResults($results, $request){
        $array = [];
        
        foreach ($results as $key => $result) {
            
        }
    }
=======
        $listings = $query->get();
        return $listings;
    }
>>>>>>> e457bfe75963f4ef18478b8769e2a94f6fca9e64
}
